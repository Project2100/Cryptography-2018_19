\mychapter{2}{Lesson 2} %180928

\section{Authentic communication}

\todo{Msg auth image (bob, eve, tag)}

\subsection{Message Authentication Code scheme}

\textbf{Syntax:}

\begin{itemize}
    \item $\K = $ Key Spac 
    \item $\M = $ Message Space
    \item $\Phi = $ Tag (or signature) Space
    \item $\Tag: \K \times \M \to \Phi$
    \item $\Ver: \K \times \M \times \Phi \to \binary$
\end{itemize}

\Tag{} and \Ver{} form a cryptographic scheme (an authentication one, in detail), and it must abide by the rule:
\[
    \forall m \in \M, \forall k \in \K \implies \Ver(k, m, \Tag(k, m)) = 1
\]

In the usual case (deterministic), the verifier consists only of an equality check, reusing the \Tag{} routine: $\Tag(k, m) = \phi$

% TODO: to review, idea/phrasing can be incorrect
The security aspect to consider in these schemes is the signatures' \emph{unforgeability}: an attacker cannot efficiently declare a couple $(m, \phi)$ such that:
\[
    \exists k \in \K \implies \Ver(k, m, \phi) = 1
\]

\begin{definition} \emph{($\varepsilon$-statistical one-time security)}: A given authentication scheme has $\varepsilon$-statistical one-time security iff, given a valid couple $(m_1, \phi_1)$, any adversary cannot \emph{forge} a fresh valid couple $(m_2, \phi_2)$ without knowing the signature key $k$. Formally:
    \begin{gather*}
        \forall m_1, m_2 \in \M : m_1 \neq m_2, \forall \phi_1, \phi_2 \in \Phi \\
        \Downarrow \\
        \Pr[\Tag(K, m_2) = \phi_2 \knowing \Tag(K, m_1) = \phi_1] \leq \varepsilon
    \end{gather*}
    
\end{definition}

\subsubsection{Pairwise-independent hashing}

\begin{definition}
    Let $\mathcal{S}$ be a seeding space; define a family of \emph{hash functions} to be the following object:
    \[
        H \in \mathcal{S} \to (\M \to \Phi) : s \mapsto h_s
    \]
    Let $S$ be a random variable in the seed space; the hash functions are deemed \emph{pairwise-independent} iff, for any two distinct messages $m$ and $m'$, the pair $(h_S(m), h_S(m'))$ distributes evenly in $\Phi^2$. In other words:
    \[
        \forall m, m' \in \M : m \neq m', \forall \phi, \phi' \in \Phi \implies \Pr[h_S(m) = \phi \wedge h_S(m') = \phi'] = \oneover{|\Phi|^2}
    \]
\end{definition}

A possible function family with this property can be constructed using prime numbers. Let $p$ be a prime number, and define the family:
\[
    h_{(a, b)}(x) = ax + b \mod p
\]

where $\S = \integer_p^2$, and $\M = \Phi = \integer_p$. Therefore, a group arises: $(\integer_p, +)$.

\begin{theorem}
    The functions in the family $H$ are pairwise-independent.
\end{theorem}

\begin{proof}
    Let $S = (a, b)$ be a random seed for $H$; for any distinct messages $m, m'$, and for any tags $\phi, \phi'$:

    \begin{align*}
        & \Pr[h_S(m) = \phi \wedge h_S(m') = \phi'] \\
        =& \Pr[am + b = \phi \wedge am' + b = \phi'] \\
        =& \Pr\left[
        \begin{pmatrix}
            m & 1 \\
            m' & 1
        \end{pmatrix}
        \cdot
        \begin{pmatrix}
            a \\
            b
        \end{pmatrix}
        =
        \begin{pmatrix}
            \phi \\
            \phi'
        \end{pmatrix}
        \right] \\
        =& \Pr\left[
        \begin{pmatrix}
            a \\
            b
        \end{pmatrix}
        =
        \begin{pmatrix}
            m & 1 \\
            m' & 1
        \end{pmatrix}^{-1}
        \cdot
        \begin{pmatrix}
            \phi \\
            \phi'
        \end{pmatrix}
        \right] \\
        =& \oneover{|\integer_p|^2}
    \end{align*}
    which is exactly the definition of pairwise-independency.
\end{proof}

\begin{theorem}
    Define an authentication scheme to be such that its tagging routine defines a function family: $\Tag(k, m)=h_k(m)$. Let this function family be pairwise-independent. Then the authentication scheme is $\oneover{|\Phi|}$-statistical one-time secure. 
\end{theorem}

\begin{proof}!
    \begin{align*}
        \forall m \in \M, \phi \in \Phi &\implies \Pr[\Tag(K, m) = \phi] = \Pr[h_K(m) = \phi] = \oneover{|\Phi|} \\
        \forall m \neq m' \in \M, \phi, \phi' \in \Phi &\implies \Pr[\Tag(K, m) = \phi \wedge \Tag(K, m') = \phi'] = \oneover{|\Phi|^2} \\
    \end{align*}
    Therefore:
    \begin{align*}
        & \Pr[\Tag(K, m) = \phi \knowing \Tag(K, m') = \phi'] \\
        =& \frac{\Pr[\Tag(K, m) = \phi \wedge \Tag(K, m') = \phi']}{\Pr[\Tag(K, m) = \phi]} \\
        =& \frac{|\Phi|}{|\Phi|^2} = \oneover{|\Phi|}
    \end{align*}
\end{proof}

\begin{theorem}
    Any ($2^{-\lambda}$)-statistical $t$-time secure authentication scheme has a key of size $(t + 1) \lambda$ for any $\lambda > 0$.
\end{theorem}

\begin{proof}
    \underline{None given.}
\end{proof}