\mychapter{2}{Lesson 2} %180928

\section{Authentic communication}

\todo{Msg auth image (bob, eve, tag)}

\subsection{Message Authentication Code scheme}

\textbf{Syntax:}

\begin{itemize}
    \item $\K = $ Key space
    \item $\M = $ Message space
    \item $\Phi = $ Tag (or signature) space
    \item $\Tag: \K \times \M \to \Phi$
    \item $\Ver: \K \times \M \times \Phi \to \binary$
\end{itemize}

\Tag{} and \Ver{} form a \emph{cryptographic authentication scheme}, or just \emph{authentication scheme}, and it must abide by the rule:
\[
    \forall m \in \M, \forall k \in \K \implies \Ver(k, m, \Tag(k, m)) = 1
\]

In the usual case (deterministic), the verifier consists only of an equality check, reusing the \Tag{} routine: $\Tag(k, m) = \phi$

The security aspect to consider in these schemes is the signatures' \emph{unforgeability}. Suppose that an attacker chooses a message $m$ and obtains its tag $\phi$ without knowing the key $k$ used in the process; then there shall be no better means of declaring a couple $(m', \phi') : \Ver(k, m', \phi') = 1$ other than random guessing, or knowing the key, of course.

Some more formal definitions of unforgeability follow:

\begin{definition} \emph{($\varepsilon$-statistical one-time security)}:
    A given authentication scheme has $\varepsilon$-statistical one-time security iff, given a valid couple $(m_1, \phi_1)$, any adversary cannot \emph{forge} a fresh valid couple $(m_2, \phi_2)$ without knowing the signature key $k$. Formally:
    \begin{gather*}
        \forall m_1, m_2 \in \M : m_1 \neq m_2, \forall \phi_1, \phi_2 \in \Phi \\
        \Downarrow \\
        \Pr[\Tag(K, m_2) = \phi_2 \knowing \Tag(K, m_1) \evaluatesto \phi_1] \leq \varepsilon
    \end{gather*}
\end{definition}

\subsubsection{Pairwise-independent hashing}

%AP190903: The math stinks here...
\begin{definition}
    Let $\mathcal{S}$ be a seeding space; define a family of \emph{hash functions} to be the following object\footnotemark:
    \[
        H \in \mathcal{S} \to (\M \to \Phi) : s \mapsto h_s
    \]

    \footnotetext{This kind of notation consisting in putting an argument as a subscript to a generic,  typically of higher-order function, is also called ``currying''; it will be used extensively throughout the lessons.}

    Let $S$ be a random variable in the seed space; the hash functions are deemed \emph{pairwise-independent}\footnotemark{} iff, for any two distinct messages $m$ and $m'$, the pair $(h_S(m), h_S(m'))$ distributes evenly in $\Phi^2$. In other words:
    \[
        \forall m, m' \in \M : m \neq m', \forall \phi, \phi' \in \Phi \implies \Pr[h_S(m) = \phi \wedge h_S(m') = \phi'] = \oneover{|\Phi|^2}
    \]
\end{definition}

\footnotetext{Care should be taken to not confuse \emph{pairwise} independency with \emph{mutual} independency: while the former acts only on pairs, the latter considers all possible subsets. The two notions are not necessarily equivalent.}

As an example of such a family, consider the additive group of integers modulo $p$: $(\integer_p, +)$, where $p$ is a prime integer. Define the family:
\[
    h_{(a, b)}(x) = ax + b \mod p
\]

where $\mathcal{S} = \integer_p^2$, and $\M = \Phi = \integer_p$. 

\begin{theorem}
    The functions in the family $H$ are pairwise-independent.
\end{theorem}

\begin{proof}
    Let $S = (a, b)$ be a random seed for $H$; for any distinct messages $m, m'$, and for any tags $\phi, \phi'$:

    \begin{align*}
        & \Pr[h_S(m) = \phi \wedge h_S(m') = \phi'] \\
        =& \Pr[am + b = \phi \wedge am' + b = \phi'] \\
        =& \Pr\left[
        \begin{pmatrix}
            m & 1 \\
            m' & 1
        \end{pmatrix}
        \cdot
        \begin{pmatrix}
            a \\
            b
        \end{pmatrix}
        =
        \begin{pmatrix}
            \phi \\
            \phi'
        \end{pmatrix}
        \right] \\
        =& \Pr\left[
        \begin{pmatrix}
            a \\
            b
        \end{pmatrix}
        =
        \begin{pmatrix}
            m & 1 \\
            m' & 1
        \end{pmatrix}^{-1}
        \cdot
        \begin{pmatrix}
            \phi \\
            \phi'
        \end{pmatrix}
        \right] \\
        =& \oneover{|\integer_p|^2}
    \end{align*}
    which is exactly the definition of pairwise-independency.
\end{proof}

\begin{theorem}
    Define an authentication scheme to be such that its tagging routine is a hash function family: $\Tag(k, m) = h_k(m)$. Let this function family be pairwise-independent. Then the authentication scheme is $\oneover{|\Phi|}$-statistical one-time secure. 
\end{theorem}

\begin{proof}
    \begin{align*}
        \forall m \in \M, \phi \in \Phi &\implies \Pr[\Tag(K, m) = \phi] = \Pr[h_K(m) = \phi] = \oneover{|\Phi|} \\
        \forall m \neq m' \in \M, \phi, \phi' \in \Phi &\implies \Pr[\Tag(K, m) = \phi \wedge \Tag(K, m') = \phi'] = \oneover{|\Phi|^2} \\
    \end{align*}
    Therefore:
    \begin{align*}
        & \Pr[\Tag(K, m') = \phi' \knowing \Tag(K, m) \evaluatesto \phi] \\
        =& \frac{\Pr[\Tag(K, m') = \phi' \wedge \Tag(K, m) = \phi]}{\Pr[\Tag(K, m) = \phi]} \\
        =& \frac{|\Phi|}{|\Phi|^2} = \oneover{|\Phi|}
    \end{align*}
\end{proof}

\begin{theorem}
    Any ($2^{-\lambda}$)-statistical $t$-time secure authentication scheme has a key of size $(t + 1) \lambda$ for any $\lambda > 0$.
\end{theorem}

\begin{proof}
    \underline{None given.}

    % IDEA: For each "time", use one "subkey"
\end{proof}
