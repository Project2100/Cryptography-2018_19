\usepackage{titletoc}


\usepackage{amsmath}
\usepackage{amsfonts}
\usepackage{amsthm}
\usepackage{amssymb}
\usepackage{thmtools}
\usepackage{acronym}
\usepackage{multirow}
\usepackage{cleveref}
\usepackage{graphicx}
\usepackage{mathtools}
\usepackage{cancel}
\usepackage{ifthen}
\usepackage{etoolbox}
\usepackage{xcolor}
\usepackage{subcaption}
\usepackage{calc}
\usepackage{preview}
\usepackage{color}
\usepackage{framed}
\usepackage{stackengine}
\usepackage{scalerel}
\usepackage{enumerate}


\newcommand{\mychapter}[2]{
    \setcounter{chapter}{#1}
    \setcounter{section}{0}
    \chapter*{#2}
    \addcontentsline{toc}{chapter}{#2}
}

% Range ligature
\newcommand{\upto}{\text{---}}

% Remainder operator, redefined in a sane way
\renewcommand{\mod}{\mathrel{\textup{mod}}}

% Group generators ofr standard assumptions
\newcommand{\groupgen}{\mathcal{GG}}

% Discrete logarithm assumption

% Grouped or
\newcommand{\biglor}{\bigvee}

% XORs
\newcommand{\bigxor}{\bigoplus}
\newcommand{\xor}{\oplus}

\newcommand{\C}{\mathcal{C}} % Cipherspace
\newcommand{\G}{\mathcal{G}} % Generally used for generators or groups
\newcommand{\K}{\mathcal{K}} % Keyspace
\newcommand{\M}{\mathcal{M}} % Messagespace
\newcommand{\X}{\mathcal{X}} % May be a RV X's domain, will soon change to the more common \Omega

\newcommand{\RO}{\mathrm{RO}} % Random oracle

\newcommand{\QR}[1][p]{\mathbb{QR}_{#1}} % Quadratic residue group

\newcommand{\Gen}{\mathrm{Gen}} % Generic generator
\newcommand{\Group}{\mathbb{G}} % Generic group


%========================================================================================================


\theoremstyle{plain}
\declaretheorem[qed=\ensuremath{\diamond}]{theorem}
\declaretheorem[qed=\ensuremath{\diamond}]{lemma}
\declaretheorem[qed=\ensuremath{\diamond}]{corollary}
\declaretheorem[qed=\ensuremath{\diamond}]{fact}
\declaretheorem[qed=\ensuremath{\diamond}]{claim}
\declaretheorem[qed=\ensuremath{\diamond}]{observation}
\declaretheorem[qed=\ensuremath{\diamond}]{proposition}

\crefname{thm}{theorem}{theorems}
\Crefname{thm}{Theorem}{Theorems}

\crefname{lem}{lemma}{lemmas}
\Crefname{lem}{Lemma}{Lemmas}

\crefname{cor}{corollary}{corollarys}
\Crefname{cor}{Corollary}{Corollarys}

\crefname{fct}{fact}{facts}
\Crefname{fct}{Fact}{Facts}

\crefname{clm}{claim}{claims}
\Crefname{clm}{Claim}{Claims}

\crefname{obs}{observation}{observations}
\Crefname{obs}{Observation}{Observations}

\crefname{prop}{proposition}{propositions}
\Crefname{prop}{Proposition}{Propositions}


\theoremstyle{definition}
\declaretheorem[qed=\ensuremath{\diamond}]{definition}
\declaretheorem[qed=\ensuremath{\diamond}]{construction}

\crefname{defn}{definition}{definitions}
\Crefname{defn}{Definition}{Definitions}

\crefname{cons}{construction}{constructions}
\Crefname{cons}{Construction}{Constructions}


% \theoremstyle{plain}
\newtheorem{thm}{Theorem}
\newtheorem{lem}{Lemma}
\newtheorem{cor}{Corollary}
\newtheorem{fct}{Fact}
\newtheorem{clm}{Claim}
\newtheorem{obs}{Observation}
\newtheorem{prop}{Proposition}
\newtheorem{question}{Question}
\newtheorem{exercise}[theorem]{Exercise}
\newtheorem{solution}{Solution}
\newtheorem{example}{Example}
% \theoremstyle{definition}
\newtheorem{defn}{Definition}
\newtheorem{cons}{Construction}



%----------------------IMAGES-----------------------------------
\usepackage[underline=false]{pgf-umlsd}
\usepackage{tikz}
\usetikzlibrary{tikzmark,decorations.pathreplacing,positioning,shapes,fit,arrows}

% From http://tex.stackexchange.com/questions/164707/how-to-use-greek-letters-in-pgf-umlsd-or-generally-terms-starting-with
\renewcommand{\mess}[4][0]{
    \stepcounter{seqlevel}
    \path
    (#2)+(0,-\theseqlevel*\unitfactor-0.7*\unitfactor) node (mess from) {};
    \addtocounter{seqlevel}{#1}
    \path
    (#4)+(0,-\theseqlevel*\unitfactor-0.7*\unitfactor) node (mess to) {};
    \draw[->,>=angle 60] (mess from) -- (mess to) node[midway, above]
    {#3};
    \node (\detokenize{#3} from) at (mess from) {};
    \node (\detokenize{#3} to) at (mess to) {};
}
% From http://tex.stackexchange.com/questions/98525/pgf-umlsd-and-externalize
\newcommand{\sdinit}{%
    \pgfdeclarelayer{umlsd@background}%
    \pgfdeclarelayer{umlsd@threadlayer}%
    \pgfsetlayers{umlsd@background,umlsd@threadlayer,main}%
}
\newcommand{\sdbegin}{%
    \setlength{\unitlength}{1cm}%
    \tikzstyle{sequence}=[coordinate]%
    \tikzstyle{inststyle}=[rectangle, draw, anchor=west, minimum
    height=0.8cm, minimum width=1.6cm, fill=white, 
    drop shadow={opacity=1,fill=black}]%
    \ifpgfumlsdroundedcorners%
        \tikzstyle{inststyle}+=[rounded corners=3mm]%
    \fi%
    \tikzstyle{blockstyle}=[anchor=north west]%
    \tikzstyle{blockcommentstyle}=[anchor=north west, font=\small]%
    \tikzstyle{dot}=[inner sep=0pt,fill=black,circle,minimum size=0.2pt]%
    \global\def\unitfactor{0.6}%
    \global\def\threadbias{center}%
    % reset counters
    \setcounter{preinst}{0}%
    \setcounter{instnum}{0}%
    \setcounter{threadnum}{0}%
    \setcounter{seqlevel}{0}%
    \setcounter{callevel}{0}%
    \setcounter{callselflevel}{0}%
    \setcounter{blocklevel}{0}%
    % origin
    \node[coordinate] (inst0) {};%
}
\newcommand{\sdend}{%
    \begin{pgfonlayer}{umlsd@background}%
        \ifnum\value{instnum}>0%
            \foreach \t [evaluate=\t] in {1,...,\theinstnum}{%
                \draw[dotted] (inst\t) -- ++(0,-\theseqlevel*\unitfactor-2.2*\unitfactor);%
            }%
        \fi%
        \ifnum\value{threadnum}>0%
            \foreach \t [evaluate=\t] in {1,...,\thethreadnum}{%
                \path (thread\t)+(0,-\theseqlevel*\unitfactor-0.1*\unitfactor) node (threadend) {};%
                \tikzstyle{threadstyle}+=[threadcolor\t]%
                \drawthread{thread\t}{threadend}%
            }%
        \fi%
    \end{pgfonlayer}%
}



\newcounter{listcount} \newcounter{totcount}
\newcommand{\printarray}[2][1em]{% \printarray[<width>]{<array list>}
    \unskip \setcounter{totcount}{0}% Reset totcount counter
    \renewcommand*{\do}[1]{\stepcounter{totcount}}% Count elements
    \docsvlist{#2}% Process list a first time to obtain # of elements
    \setcounter{listcount}{0}% Reset listcount counter
    \renewcommand*{\do}[1]{%
        \stepcounter{listcount}% Move to next element
        \framebox[#1][c]{\rule{0pt}{1.5ex}\smash{\ensuremath{##1}}}%
        \ifnum\value{listcount}<\value{totcount}\thickspace\fi
    }
    \docsvlist{#2}% Process list a second time to typeset each element
}


% \newcommand{\thmsymbol}{\( \diamond \)}
% \newenvironment{definition}{\begin{defn}%
% \renewcommand{\qedsymbol}{\thmsymbol}\pushQED{\qed}}%
% {\popQED\end{defn}}
% \newenvironment{construction}{\begin{cons}%
% \renewcommand{\qedsymbol}{\thmsymbol}\pushQED{\qed}}%
% {\popQED\end{cons}}
% \newenvironment{theorem}{\begin{thm}%
% \renewcommand{\qedsymbol}{\thmsymbol}\pushQED{\qed}}%
% {\popQED\end{thm}}
% \newenvironment{lemma}{\begin{lem}%
% \renewcommand{\qedsymbol}{\thmsymbol}\pushQED{\qed}}%
% {\popQED\end{lem}}
% \newenvironment{corollary}{\begin{cor}%
% \renewcommand{\qedsymbol}{\thmsymbol}\pushQED{\qed}}%
% {\popQED\end{cor}}
% \newenvironment{fact}{\begin{fct}%
% \renewcommand{\qedsymbol}{\thmsymbol}\pushQED{\qed}}%
% {\popQED\end{fct}}
% \newenvironment{claim}{\begin{clm}%
% \renewcommand{\qedsymbol}{\thmsymbol}\pushQED{\qed}}%
% {\popQED\end{clm}}
% \newenvironment{observation}{\begin{obs}%
% \renewcommand{\qedsymbol}{\thmsymbol}\pushQED{\qed}}%
% {\popQED\end{obs}}
% \newenvironment{proposition}{\begin{prop}%
% \renewcommand{\qedsymbol}{\thmsymbol}\pushQED{\qed}}%
% {\popQED\end{prop}}


% \renewcommand{\thmtformatoptarg}[1]{ #1}
% \setcounter{chapter}{4}
